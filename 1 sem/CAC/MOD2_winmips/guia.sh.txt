#!/bin/bash
#defino la ruta del archivo
archivo="/var/log/municipios.txt"

#veo q exista
if [ ! -f $archivo ]; then  #! -f: si no es un archivo entra
  echo " El archivo $archivo no existe."
  exit 1
fi

#inicializo el arreglo
MUNICIPIOS=()

#defino funciones q piden
function existeMunicipio {
  local municipio=$1 #por parametro un nombre y ve si existe en el; arreglo
  for i in ${MUNICIPIOS[@]}; do #[@] me ayuda a iterar sobre cada elemento.
    if [ $i = $municipio ]; then #si encontro retorna
      return 0
    fi
  done
  return  1 #si no econtro retorna 1
}

function agregarMunicipio {
  if [ $# -ne 1 ]; then #corroboro parametro
    echo "Error: no se recibio el nombre"
    return 1
  fi
  
  local municipio=$1
  existeMunicipio $municipio #llamo al otro proceso
  if [ $? -eq 0 ]; then #$? representa el estado de salida del ultimo comando.
  #si la funcion devuelve 0, es pq la funcion encotro el nombre entnces entra a>
    echo "Error: el municipio $municipio ya existe en el arreglo"
    return 1;
  fi
#si todo esta bien, agrego el municipio
  MUNICIPIOS+=($municipio)
return 0
}

#para imprimir los municipos
function listarMunicipios {
  echo "municipios:"
  for i in ${MUNICIPIOS[@]}; do
    echo "$i"
  done
}

#cantidad de municipios
function cantidadMunicipios {
  echo "Cantidad de municipios: ${#MUNICIPIOS[@]}"
}

function municipioMasPoblado {
  local maxPoblacion=0
  local nombreMunicipio=""
  while read -r linea; do #al final del while le digo de donde leer al read
    poblacion=$(echo $linea | cut -d' ' -f2) #segun el formato q me dieron en e>
    if [ $poblacion -gt $maxPoblacion ]; then #a>b
      maxPoblacion=$poblacion
      nombreMunicipio=$(echo $linea | cut -d' ' -f1) #nombre del municipio
    fi
  done < $archivo #q el read lea desde aca
  echo "Municipio mas poblado: $nombreMunicipio con $maxPoblacion habitantes"
}

#leemos el archivo y agregamos los municipios al arreglo
  while read -r linea; do
    municipios=$(echo $linea | cut -d' ' -f1) #me quedo con el nombre
    agregarMunicipio $municipios #agrega al arreglo
done < $archivo #para q leadesde archivo, q es municipios

listarMunicipios
cantidadMunicipios
municipioMasPoblado

exitÂ 0